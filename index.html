<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>그루텍스 통합 관리 시스템</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        #loader { position: fixed; left: 0; top: 0; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; background-color: #f5f5f5; font-size: 1.2rem; font-weight: bold; color: #667eea; z-index: 9999; }
        .header { position: relative; }
    </style>
</head>
<body>
    <div id="loader"><p>인증 정보를 확인하는 중...</p></div>
    <div id="app-content" style="display: none;">
        <div class="container">
            <div class="header">
                <h1>그루텍스 통합 관리 시스템 v4.4</h1>
                <button id="logout-button" class="btn btn-danger" style="position:absolute; top: 20px; right: 30px;">로그아웃</button>
            </div>
            <div id="backup-reminder-alert" class="backup-alert" style="display: none;">
                🔔 이번 달은 백업을 할 차례입니다! '데이터 백업/복원' 탭에서 중요 데이터를 백업해주세요.
                <button id="backup-reminder-btn" class="btn btn-warning">백업하러 가기</button>
            </div>
            <div class="tab-container">
                <div class="tab active" data-tab="transaction">입출고 현황</div>
                <div class="tab" data-tab="inventory">재고 관리</div>
                <div class="tab" data-tab="import-cost">수입원가 정산</div>
                <div class="tab" data-tab="invoice">거래명세표</div>
                <div class="tab" data-tab="sales-report">매출 보고서</div>
                <div class="tab" data-tab="backup">데이터 백업/복원</div>
            </div>

            <div id="transaction" class="tab-content active">
                <div class="section">
                    <h3 id="transaction-form-title">입출고 등록</h3>
                    <div class="input-group"> 
                        <div class="input-field"><label>구분*</label><select id="transaction-type"><option value="입고">입고</option><option value="출고">출고</option></select></div>
                        <div class="input-field"><label>날짜*</label><input type="date" id="transaction-date" required></div>
                        <div class="input-field"><label>브랜드*</label><input type="text" id="tran-brand" list="brand-list" placeholder="기존 선택 또는 신규 입력" required> <datalist id="brand-list"></datalist></div>
                        <div class="input-field"><label>LOT*</label><input type="text" id="tran-lot" list="lot-list" placeholder="기존 선택 또는 신규 입력" required><datalist id="lot-list"></datalist></div>
                        <div class="input-field"><label>품목 구분</label><input type="text" id="tran-category" placeholder="신규 입고 시 입력"></div>
                        <div class="input-field"><label>스펙</label><input type="text" id="tran-spec" placeholder="신규 입고 시 입력"></div>
                        <div class="input-field"><label>중량(kg)*</label><input type="number" id="transaction-weight" required></div>
                        <div class="input-field"><label>단가(원/kg)</label><input type="number" id="transaction-unit-price" placeholder="선택 사항"></div>
                        <div class="input-field"><label>업체*</label><input type="text" id="transaction-company" list="company-list-tran" placeholder="거래 업체명" required><datalist id="company-list-tran"></datalist></div>
                        <div class="input-field" id="other-costs-field" style="display: none;"><label>기타 비용(원)</label><input type="number" id="transaction-other-costs" placeholder="운송비, 부대비용 등"></div>
                        <div class="input-field"><label>비고</label><input type="text" id="transaction-notes"></div>
                        <div class="input-field"><label>도착지</label><input type="text" id="transaction-destination"></div>
                        <div class="input-field"><label>특이사항</label><input type="text" id="transaction-special-notes"></div>
                    </div>
                    <div class="btn-group" id="transaction-form-buttons">
                        <button class="btn btn-primary">입출고 등록</button>
                        <button class="btn btn-warning">대량 입출고 등록</button>
                    </div>
                </div>
                 <div class="section filter-section">
                    <h3>입출고 내역 필터</h3>
                    <div class="filter-group">
                        <select id="filter-tran-type"><option value="">거래구분 (전체)</option><option value="입고">입고</option><option value="출고">출고</option></select>
                        <input type="month" id="filter-tran-month">
                        <input type="text" id="filter-tran-brand" placeholder="브랜드 검색">
                        <input type="text" id="filter-tran-category" placeholder="품목 구분 검색">
                        <input type="text" id="filter-tran-spec" placeholder="스펙 검색">
                        <input type="text" id="filter-tran-lot" placeholder="LOT 검색">
                        <input type="text" id="filter-tran-company" placeholder="업체 검색">
                    </div>
                     <button class="btn btn-secondary">필터 초기화</button>
                </div>
                <div class="section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3>입출고 내역</h3>
                        <div class="btn-group">
                            <button class="btn btn-warning">✏️ 선택 수정</button>
                            <button class="btn btn-danger">🗑️ 선택 삭제</button>
                            <button class="btn btn-success">📊 CSV 내보내기</button>
                        </div>
                    </div>
                    <table class="transaction-table">
                        <thead>
                            <tr>
                                 <th><input type="checkbox" id="select-all-transactions"></th>
                                <th>거래구분</th><th>날짜</th><th>브랜드</th><th>품목구분</th><th>스펙</th><th>LOT</th><th>중량(kg)</th><th>단가(원/kg)</th><th>금액(원)</th><th>기타 비용(원)</th><th>업체</th><th>비고</th><th>도착지</th><th>특이사항</th>
                            </tr>
                        </thead>
                        <tbody id="transaction-tbody"></tbody>
                        <tfoot>
                            <tr>
                                <td colspan="7" style="text-align:center;">합계</td>
                                <td id="total-tran-weight" style="text-align:left;"></td>
                                <td></td>
                                <td id="total-tran-amount" style="text-align:left;"></td>
                                <td id="total-tran-other-costs" style="text-align:left;"></td>
                                <td colspan="4"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <div id="inventory" class="tab-content">
                </div>

            </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="./scripts/app.js"></script>
</body>
</html>
